---
name: Исследование экспертизы ЯМР
overview: "План верификации экспертизы давности документа по ЯМР: программатический разбор calculations.pdf и проверка формул, статистический анализ подозрительной однородности D, извлечение и анализ графиков (в т.ч. через LLM/vision), кросс-проверка с методологией и протоколами."
todos: []
isProject: false
---

# План исследования экспертизы давности документа (ЯМР)

## Краткий контекст по документам

**Методология** ([methodology.pdf](methodology.pdf)): определение давности по целлюлозе — K1, K2 (кристалличность), Pr1, Pr2 (плотность протонов); G = K2/K1 + Pr2/Pr1; калибровка по двум измерениям (первое и через ≥15 дней); D (давность в месяцах) по калибровочной прямой. В приложении — протоколы 1246, 1247, 1248 (Договор дарения, купли-продажи, Свидетельство) с конкретными K1, Pr1, K2, Pr2 для первого и повторного (+30 дней) измерений.

**Вычисления** ([calculations.pdf](calculations.pdf)): таблицы с K1, K2, L1, L2, P1, P2, R1, R2 (P/R — аналог Pr при первом/втором измерении, L — K при втором); G1 = K2/K1 + P2/P1, G2 = L2/L1 + R2/R1, G = G2−G1, **D = G1/G**. Есть явные проверочные строки.

**Графики** ([graphics_without_coverage.pdf](graphics_without_coverage.pdf)): 78 страниц с подписями к иллюстрациям ЯМР (подписи, печати, объекты 1–12, первый и третий прокол). Сам график на каждой странице — изображение (в тексте PDF извлечены только подписи).

---

## Критическое наблюдение по calculations.pdf

**Почти все значения D одинаковые:** в подавляющем большинстве блоков **D = 57.42 или 57.43** месяцев, в одном блоке — **56.24–56.26**. При этом входные K1, K2, P1, P2, L1, L2, R1, R2 сильно различаются (разные объекты/реквизиты). Получить одну и ту же давность с точностью до сотых для десятков разных образцов физически маловероятно и даёт основание подозревать подгонку результата под заданное D.

---

## Оценка вашего подхода

- **Парсить вычисления и проверять формулы** — верно и эффективно; **calculations.pdf уже структурирован** (числа и формулы в тексте), поэтому разбор лучше делать **программой** (скрипт парсинга + пересчёт G1, G2, G, D), а не постраничной отправкой в LLM.
- **Парсить графики через LLM постранично** — разумно для качественного анализа (описание кривой, оси, аномалии, дубликаты), но для **точного извлечения чисел** (амплитуды, времена релаксации) LLM по изображению даёт низкую точность. Имеет смысл комбинировать: LLM — описание и проверка на «кривизну»/дубли; для выборочной количественной проверки — либо ручной/полуавтоматический digitizer графиков, либо явное указание LLM «оценить порядок величин с графика» с последующей сверкой с расчётами.

---

## Предлагаемая структура исследования

### 1. Парсинг и верификация calculations.pdf

- Извлечь из PDF текст (или использовать уже извлечённый текст).
- Регулярными выражениями/парсером вытащить блоки: K1, K2, L1, L2, P1, P2, R1, R2, G1, G2, G, D.
- Для каждого блока независимо пересчитать:
  - G1_check = K2/K1 + P2/P1
  - G2_check = L2/L1 + R2/R1
  - G_check = G2 − G1
  - D_check = G1 / G
- Сравнить с заявленными G1, G2, G, D; зафиксировать расхождения (округление допускается в пределах разумного, например 0.01).
- Проверить соответствие формулам методологии: формула (1) для G, формула (2) и смысл калибровки (D = G1/G при Δt = 1 месяц).

**Результат:** отчёт: какие блоки совпадают, где есть арифметические ошибки или несоответствия.

### 2. Статистический анализ подозрительной однородности D

- По всем распарсенным блокам построить распределение D (гистограмма, базовая статистика).
- Зафиксировать факт: почти все D ≈ 57.42 или 56.25 при разнородных входах.
- Оценить (хотя бы качественно): при случайных «честных» измерениях разброс D между образцами был бы существенным; концентрация в одной точке — аргумент в пользу подгонки.

**Результат:** краткий статистический вывод и формулировка риска подгонки под заданный результат.

### 3. Связь с протоколами из methodology.pdf

- В методологии есть протоколы 1246, 1247, 1248 (первое и +30 дней) с конкретными K1, Pr1, K2, Pr2.
- Сопоставить обозначения: в calculations используются P1, P2 (Pr1, Pr2) и L1, L2 (K1, K2 при втором измерении).
- Проверить, есть ли в calculations.pdf строки, где K1, K2, P1, P2 совпадают (в пределах округления) со средними по протоколу 1246/1247/1248; аналогично для второго измерения (L1, L2, R1, R2).
- Если совпадений нет — явно указать, что calculations относятся к другому набору данных (другое дело/объекты), и тогда протоколы из methodology нельзя напрямую сверить с calculations по числовым значениям, но формулы и логика калибровки остаются общими.

**Результат:** таблица соответствия (или отсутствия соответствия) протокол ↔ расчёты; вывод о том, один ли это кейс.

### 4. Графики (graphics_without_coverage.pdf)

**4.1. Извлечение страниц как изображений**

- Конвертировать каждую страницу PDF в изображение (например, pdf2image, poppler, или через другой PDF→image инструмент), чтобы передавать в vision-модель или digitizer.

**4.2. Анализ с помощью LLM (vision)**

- Для каждой страницы (или выборочно для репрезентативной части) отправлять изображение в LLM с чётким промптом, например:
  - описать тип графика (оси: время/амплитуда? ССИ?);
  - описать форму кривой (спад, два компонента и т.д.);
  - если на графике есть подписи числовых значений — оценить их;
  - отметить артефакты, обрезку, нечитаемость.
- Отдельно попросить сравнить пары изображений (например, «первый прокол» vs «третий прокол» для одного и того же объекта/подписи): не являются ли графики дубликатами или почти идентичными.
- Сводная таблица: номер иллюстрации, объект, тип реквизита, прокол — краткое описание графика и флаги «похож на дубликат», «аномалия».

**4.3. Дубликаты и аномалии**

- По результатам LLM составить список пар (или групп) страниц с пометкой «возможный дубликат».
- Дополнительно можно вычислить перцептивный хэш или простой хэш изображений страниц и искать совпадения — для объективной проверки дублирования.

**4.4. Количественная проверка (опционально, выборочно)**

- Для нескольких страниц с наиболее читаемыми осями: использовать WebPlotDigitizer или скрипт с opencv/подбором кривой для извлечения приближённых значений амплитуды (и при возможности времени релаксации).
- Сравнить с теми K/Pr, которые в calculations или в протоколах соответствуют этому объекту/реквизиту. Цель — не полная реконструкция, а проверка «того же порядка» и отсутствия грубых противоречий.

**Результат:** отчёт по графикам: описание, дубликаты, аномалии; при наличии — сравнение выборочных цифр с расчётами.

### 5. Сводный отчёт и выводы

- Верификация формул: все ли расчёты в calculations.pdf совпадают с пересчётом.
- Статистика D: однородность 57.42/56.25 как признак возможной подгонки.
- Соответствие методологии: использование правильных формул (1) и (2), учёт Δt.
- Связь протоколов methodology и calculations: один кейс или разные.
- Графики: дубликаты, кривые, противоречия с цифрами.
- Итоговый вывод: есть ли в вычислениях и графиках признаки подгонки или нарушения методологии; перечень конкретных несоответствий и рисков.

---

## Технические рекомендации

- **Парсинг calculations:** Python (PyPDF2 или pdfplumber для текста) + regex или простой конечный автомат по строкам; вычисления — на Python (NumPy не обязателен, достаточно float).
- **Графики:** Python: pdf2image (или pdftoppm), сохранение страниц как PNG; затем вызов vision API (OpenAI, Claude, и т.д.) с промптом по шаблону выше; для дубликатов — imagehash (pHash/dHash).
- **Хранение:** структурированные данные (JSON/CSV) по блокам расчётов и по описаниям графиков — для повторяемости и отчётности.

---

## Порядок работ (предлагаемый)

1. Парсинг и верификация calculations.pdf (формулы и арифметика).
2. Статистика D и формулировка вывода о подозрительной однородности.
3. Сопоставление с протоколами methodology (если нужно — уточнить обозначения P/R vs Pr, L vs K второе измерение).
4. Извлечение изображений из graphics_without_coverage.pdf и анализ через LLM (описание + дубликаты).
5. При необходимости — выборочная оцифровка нескольких графиков и сравнение с расчётами.
6. Написание сводного отчёта с выводами и перечнем найденных несоответствий.

Если нужно, могу следующим шагом расписать конкретные форматы промптов для LLM по графикам и пример кода парсера для calculations.pdf (без выполнения кода, только план/псевдокод).